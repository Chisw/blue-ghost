<!DOCTYPE html>
<html>
  <head>
    <title>Blue Ghost Popup</title>
    <meta charset="utf-8" />
    <link rel="stylesheet" type="text/css" href="../static/css/tailwind.min.css" />
    <link rel="stylesheet" type="text/css" href="../static/css/element.min.css" />
    <link rel="stylesheet" type="text/css" href="./style.css" />
  </head>
  <body>
    <div id="blue-ghost-popup" style="width:480px;">
      <el-tabs type="border-card" v-model="activeTab">

        <el-tab-pane name="bookmark">
          <span slot="label"><i class="el-icon-star-off"></i> 书签</span>
          <div>
            <el-input
              autofocus
              size="small"
              placeholder="请输入站点名称、拼音、拼音首字母"
              v-model="bookmarkValue"
            >
              <i class="el-icon-search" slot="prepend"></i>
            </el-input>
            <div class="mt-4 -mx-4 -mb-4 overflow-x-hidden overflow-y-auto" style="height: 450px;">
              <div v-if="displayBookmarks.length === 0" class="p-4 text-gray-600 text-center">
                {{bookmarkValue ? '没有匹配到书签' : '加载中..'}}
              </div>
              <a
                target="_blank"
                class="block px-4 py-1 hover:text-blue-600 hover:bg-gray-100 focus:bg-gray-300 focus:outline-none border-t break-all"
                v-for="(bookmark, index) in displayBookmarks"
                :key="index"
                :href="bookmark.url"
              >
                <div class="flex items-center">
                  <img
                    class="block w-4 h-4"
                    :src="`chrome://favicon/size/16@2x/${bookmark.url}`"
                  />
                  <div class="ml-4 w-full">
                    <p class="font-semibold w-10/12 truncate">{{bookmark.title}}</p>
                    <p class="text-gray-500 w-10/12 truncate">{{bookmark.url}}</p>
                    <!-- <p class="text-gray-500">{{bookmark.matchList}}</p> -->
                  </div>
                </div>
              </a>
            </div>
          </div>
        </el-tab-pane>

        <el-tab-pane name="site">
          <span slot="label"><i class="el-icon-monitor"></i> 站点</span>
          <div class="flex items-center">
            <img class="w-5 h-5" :src="site.favIconUrl || '../img/icon.svg'" />
            <el-input
              autofocus
              size="small"
              class="flex-grow ml-2"
              v-model="site.title"
              placeholder="Site title"
            />
          </div>
          <p class="mt-2 text-xs text-gray-500 truncate">{{site.url}}</p>
          <div class="mt-2 flex items-center">
            <div class="flex-grow mr-4">
              <el-alert
                v-if="site.url.length > 512"
                type="error"
                title="URL is too long"
                :closable="false"
              >
            </el-alert>
            </div>
            <el-button
              round
              size="mini"
              type="primary"
              icon="el-icon-upload"
              @click="pickSite"
              :disabled="pickSiteDisabled"
            >
              Pick
            </el-button>
          </div>
        </el-tab-pane>

        <el-tab-pane name="config">
          <span slot="label"><i class="el-icon-setting"></i> 配置</span>
          <div>
            <el-input
              size="small"
              v-model="config.api"
              placeholder="API url"
              @input="updateConfig"
            >
              <template slot="prepend">API</template>
            </el-input>
            <el-input
              size="small"
              v-model="config.token"
              placeholder="Token code"
              type="password"
              class="mt-2"
              @input="updateConfig"
            >
              <template slot="prepend">Token</template>
            </el-input>
            <el-input
              size="small"
              v-model="config.newTab"
              placeholder="New tab url"
              class="mt-2"
              @input="updateConfig"
            >
              <template slot="prepend">NewTab</template>
            </el-input>
          </div>
        </el-tab-pane>

      </el-tabs>

      <div class="absolute top-0 right-0 p-2">
        <el-tooltip
          effect="dark"
          content="DEV: Reload Blue Ghost"
          placement="bottom"
        >
          <el-button
            circle
            size="mini"
            icon="el-icon-refresh-left"
            @click="chrome.runtime.reload()"
          >
          </el-button>
        </el-tooltip>
      </div>

    </div>
  </body>
  <script src="../static/js/luxon.min.js"></script>
  <script src="../static/js/vue.min.js"></script>
  <script src="../static/js/element.min.js"></script>
  <script src="../content-script/pinyin.js"></script>
  <script src="./popup.js"></script>
</html>